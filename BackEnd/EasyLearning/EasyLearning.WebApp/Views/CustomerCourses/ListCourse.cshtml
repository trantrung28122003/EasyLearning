@model EasyLearning.WebApp.Models.CoursesByCategoryViewModel

@{
    ViewData["Title"] = "ListCourse";
}

<link href="~/css/CourseList.css" rel="stylesheet" />
<div class="main-container">
    
    <form asp-action="ListCourse" asp-controller="CustomerCourses" method="get">
        <div class="input-group mb-3 ">
            <input type="text" class="form-control" name="searchString" placeholder="Search..." aria-label="Search" aria-describedby="button-addon2" style="border-radius: 15px 0px 0px 15px;width:800px">
            <button class="btn" type="submit" id="button-addon2" style="border-radius: 0px 15px 15px 0px; background-color: #06BBCC; color: #fff">Search</button>
        </div>
    </form>
    <!--<form asp-action="ListCourse" asp-controller="CustomerCourses" method="get">
        <div class="input-group custom-input mb-3">
            <input type="text" name="searchString" class="form-control" placeholder="Search" aria-label="Search" aria-describedby="basic-addon2">
            <input type="text" name="searchString" placeholder="Search..." />
            <input type="submit" value="Search" />
        </div>
    </form>-->
    


    @foreach (var itemCategory in Model.Categories)
    {

        bool hasCourses = Model.CourseDetails.Any(cd => cd.CategoryId == itemCategory.Id);
        if (!hasCourses)
        {
            continue;
        }
        <div class="container-xxl py-5">
            <div class="container">
                <div class="text-center wow fadeInUp" data-wow-delay="0.1s">
                    <h6 class="section-title bg-white text-center text-primary px-3">Các Khóa Học</h6>
                    <h1 class="mb-5">Các Khóa Học của @itemCategory.CategoryName</h1>
                </div>
                <div class="row g-4 justify-content-center">
                    @foreach (var itemCourseDetail in Model.CourseDetails)
                    {
                        if (itemCourseDetail.CategoryId == itemCategory.Id)
                        {
                            foreach (var itemCourse in Model.Courses)
                            {
                                if (itemCourse.Id == itemCourseDetail.CourseId)
                                {


                                    <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.1s">
                                        <div class="course-item bg-light">
                                            <div class="position-relative overflow-hidden">
                                                <img class="img-fluid" src="~/img/course-1.jpg" alt="">
                                                <div class="w-100 d-flex justify-content-center position-absolute bottom-0 start-0 mb-4">
                                                    <a asp-controller="CustomerCourses" asp-action="DetailCourse" asp-route-courseId="@itemCourse.Id" class="flex-shrink-0 btn btn-sm btn-primary px-3 border-end" style="border-radius: 30px 0 0 30px;">Xem Thêm</a>
                                                    <a asp-controller="ShoppingCart" asp-route-courseId="@itemCourse.Id" class="flex-shrink-0 btn btn-sm btn-primary px-3" style="border-radius: 0 30px 30px 0;">Tham Gia Ngay</a>
                                                </div>
                                            </div>
                                            <div class="text-center p-4 pb-0">
                                                <h3 class="mb-0">@itemCourse.CoursesPrice VNĐ</h3>
                                                <div class="mb-3">
                                                    <small class="fa fa-star text-primary"></small>
                                                    <small class="fa fa-star text-primary"></small>
                                                    <small class="fa fa-star text-primary"></small>
                                                    <small class="fa fa-star text-primary"></small>
                                                    <small class="fa fa-star text-primary"></small>
                                                    <small>(123)</small>
                                                </div>
                                                <h5 class="mb-4">@itemCourse.CoursesName</h5>
                                            </div>
                                            <div class="d-flex border-top">
                                                <small class="flex-fill text-center border-end py-2"><i class="fa fa-user-tie text-primary me-2"></i>@itemCourse.Instructor</small>
                                                @{
                                                    //Lấy ngày bắt đầu và kết thúc từ các thuộc tính StartDate và EndDate của itemCourse
                                                    DateTime startDate = itemCourse.StartDate;
                                                    DateTime endDate = itemCourse.EndDate;

                                                    // Tính toán khoảng thời gian giữa hai ngày
                                                    TimeSpan duration = endDate - startDate;

                                                    // Lấy số giờ từ khoảng thời gian
                                                    double hours = duration.TotalHours;
                                                }
                                                <small class="flex-fill text-center border-end py-2"><i class="fa fa-clock text-primary me-2"></i>@hours Giờ</small>
                                                <small class="flex-fill text-center py-2"><i class="fa fa-user text-primary me-2"></i>@itemCourse.MaxAttdendees</small>
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                        }
                    }
                </div>
            </div>
        </div>
    }
</div>
